<!--<!DOCTYPE html>-->
<!--<html lang="ru" xmlns:th="http://www.thymeleaf.org">-->
<!--<div th:replace="~{fragments/head}"></div>-->
<!--<body>-->

<!--&lt;!&ndash; Header &ndash;&gt;-->
<!--<div th:replace="~{fragments/header}"></div>-->


<!--<div class="container my-5">-->
<!--    <div class="row">-->
<!--        &lt;!&ndash; Sidebar for filters &ndash;&gt;-->
<!--        <div th:replace="~{fragments/filter}"></div>-->

<!--        &lt;!&ndash; Product Listings &ndash;&gt;-->
<!--        <div class="col-md-9">-->
<!--            <div class="row row-cols-1 row-cols-md-3 g-4">-->

<!--&lt;!&ndash;                <div class="col" th:each="smartphone : ${smartphones}" th:id="'product-' + ${smartphone.id}">&ndash;&gt;-->

<!--&lt;!&ndash;                    <div class="product-card border p-3 d-flex flex-column h-100 position-relative">&ndash;&gt;-->
<!--&lt;!&ndash;                        <a th:href="@{/smartphones/{id}(id=${smartphone.id})}"&ndash;&gt;-->
<!--&lt;!&ndash;                           class="text-decoration-none text-dark h-100 d-flex flex-column">&ndash;&gt;-->
<!--&lt;!&ndash;                            <img src="https://via.placeholder.com/150" alt="Smartphone Image"&ndash;&gt;-->
<!--&lt;!&ndash;                                 class="product-image w-100">&ndash;&gt;-->

<!--&lt;!&ndash;                            <h6 class="mt-auto" th:text="${smartphone.fullName}"></h6>&ndash;&gt;-->

<!--&lt;!&ndash;                            &lt;!&ndash; Значок скидки, отображается в верхнем правом углу, если есть скидка &ndash;&gt;&ndash;&gt;-->
<!--&lt;!&ndash;                            <span th:if="${smartphone.discount > 0}"&ndash;&gt;-->
<!--&lt;!&ndash;                                  class="badge bg-danger position-absolute top-0 end-0 rounded-pill"&ndash;&gt;-->
<!--&lt;!&ndash;                                  th:text="${'-' + smartphone.discount + '%'}">&ndash;&gt;-->
<!--&lt;!&ndash;                        </span>&ndash;&gt;-->
<!--&lt;!&ndash;                        </a>&ndash;&gt;-->
<!--&lt;!&ndash;                        &lt;!&ndash; Блок с ценами для выравнивания &ndash;&gt;&ndash;&gt;-->
<!--&lt;!&ndash;                        <div class="mt-auto">&ndash;&gt;-->
<!--&lt;!&ndash;                            &lt;!&ndash; Если есть скидка, показывается PriceWithDiscount, а PriceExDiscount зачёркнут &ndash;&gt;&ndash;&gt;-->
<!--&lt;!&ndash;                            <span th:if="${smartphone.discount > 0}" class="product-price fw-bold text-primary mb-0"&ndash;&gt;-->
<!--&lt;!&ndash;                                  th:text="${smartphone.priceWithDiscount + ' ₽'}">&ndash;&gt;-->
<!--&lt;!&ndash;                            </span>&ndash;&gt;-->
<!--&lt;!&ndash;                            <span th:if="${smartphone.discount > 0}"&ndash;&gt;-->
<!--&lt;!&ndash;                                  class="text-muted text-decoration-line-through mb-0"&ndash;&gt;-->
<!--&lt;!&ndash;                                  th:text="${smartphone.priceExDiscount + ' ₽'}">&ndash;&gt;-->
<!--&lt;!&ndash;                            </span>&ndash;&gt;-->

<!--&lt;!&ndash;                            &lt;!&ndash; Если скидки нет, показывается только PriceExDiscount без зачёркивания &ndash;&gt;&ndash;&gt;-->
<!--&lt;!&ndash;                            <p th:if="${smartphone.discount == 0}" class="fw-bold text-primary mb-0"&ndash;&gt;-->
<!--&lt;!&ndash;                               th:text="${smartphone.priceExDiscount + ' ₽'}">&ndash;&gt;-->
<!--&lt;!&ndash;                            </p>&ndash;&gt;-->
<!--&lt;!&ndash;                        </div>&ndash;&gt;-->

<!--&lt;!&ndash;                        &lt;!&ndash; Количество товара и кнопки " + " и " - " &ndash;&gt;&ndash;&gt;-->
<!--&lt;!&ndash;                        <div class="mt-3">&ndash;&gt;-->
<!--&lt;!&ndash;                            <button class="decrement-btn btn btn-sm btn-outline-secondary"&ndash;&gt;-->
<!--&lt;!&ndash;                                    th:data-id="${smartphone.id}">- &ndash;&gt;-->
<!--&lt;!&ndash;                            </button>&ndash;&gt;-->
<!--&lt;!&ndash;                            <span th:id="'quantity-' + ${smartphone.id}" class="mx-2" th:text="0">0</span>&ndash;&gt;-->
<!--&lt;!&ndash;                            <button class="increment-btn btn btn-sm btn-outline-secondary" th:data-id="${smartphone.id}"&ndash;&gt;-->
<!--&lt;!&ndash;                                    th:data-stock="${smartphone.count}">+&ndash;&gt;-->
<!--&lt;!&ndash;                            </button>&ndash;&gt;-->
<!--&lt;!&ndash;                        </div>&ndash;&gt;-->

<!--&lt;!&ndash;                        &lt;!&ndash; Кнопка "В корзину", всегда располагается внизу &ndash;&gt;&ndash;&gt;-->
<!--&lt;!&ndash;                        <form class="mt-3" method="post" th:action="@{/cart/${smartphone.id}}">&ndash;&gt;-->
<!--&lt;!&ndash;                            <button class="btn btn-primary btn-sm w-100">В корзину</button>&ndash;&gt;-->
<!--&lt;!&ndash;                        </form>&ndash;&gt;-->
<!--&lt;!&ndash;                    </div>&ndash;&gt;-->
<!--&lt;!&ndash;                    </a>&ndash;&gt;-->
<!--&lt;!&ndash;                </div>&ndash;&gt;-->

<!--                <div class="col" th:each="smartphone : ${smartphones}" th:id="'product-' + ${smartphone.id}">-->

<!--                    <div class="product-card border p-3 d-flex flex-column h-100 position-relative">-->
<!--                        <a th:href="@{/smartphones/{id}(id=${smartphone.id})}"-->
<!--                           class="text-decoration-none text-dark h-100 d-flex flex-column">-->
<!--                            <img src="https://via.placeholder.com/150" alt="Smartphone Image"-->
<!--                                 class="product-image w-100">-->

<!--                            <h6 class="mt-auto" th:text="${smartphone.fullName}"></h6>-->

<!--                            <span th:if="${smartphone.discount > 0}"-->
<!--                                  class="badge bg-danger position-absolute top-0 end-0 rounded-pill"-->
<!--                                  th:text="${'-' + smartphone.discount + '%'}"></span>-->
<!--                        </a>-->

<!--                        <div class="mt-auto">-->
<!--                            <span th:if="${smartphone.discount > 0}" class="product-price fw-bold text-primary mb-0"-->
<!--                                  th:text="${smartphone.priceWithDiscount + ' ₽'}"></span>-->
<!--                            <span th:if="${smartphone.discount > 0}"-->
<!--                                  class="text-muted text-decoration-line-through mb-0"-->
<!--                                  th:text="${smartphone.priceExDiscount + ' ₽'}"></span>-->

<!--                            <p th:if="${smartphone.discount == 0}" class="fw-bold text-primary mb-0"-->
<!--                               th:text="${smartphone.priceExDiscount + ' ₽'}"></p>-->
<!--                        </div>-->

<!--                        &lt;!&ndash; Количество товара и кнопки " + " и " - " &ndash;&gt;-->
<!--                        <div class="mt-3">-->
<!--                            <button class="decrement-btn btn btn-sm btn-outline-secondary"-->
<!--                                    th:data-id="${smartphone.id}">-</button>-->
<!--                            <span th:id="'quantity-' + ${smartphone.id}" class="mx-2" th:text="0">0</span>-->
<!--                            <button class="increment-btn btn btn-sm btn-outline-secondary"-->
<!--                                    th:data-id="${smartphone.id}" th:data-stock="${smartphone.count}">+</button>-->
<!--                        </div>-->

<!--                        &lt;!&ndash; Кнопка "В корзину" или счётчик в зависимости от количества &ndash;&gt;-->
<!--                        <div class="mt-3">-->
<!--                            <button class="btn btn-primary btn-sm w-100 add-to-cart-btn"-->
<!--                                    th:data-id="${smartphone.id}" style="display: none;">В корзину</button>-->
<!--                            <div class="cart-counter" th:id="'cart-counter-' + ${smartphone.id}"-->
<!--                                 style="display: none;">-->
<!--                                <span th:id="'quantity-in-cart-' + ${smartphone.id}" th:text="0"></span>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->
<!--                </div>-->


<!--            </div>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->


<!--<div th:replace="~{fragments/footer}"></div>-->

<!--<script>-->
<!--    // document.querySelectorAll(".increment-btn").forEach(button => {-->
<!--    //     button.addEventListener("click", function () {-->
<!--    //         const productId = this.dataset.id;-->
<!--    //         const stock = parseInt(this.dataset.stock); // Доступное количество товара-->
<!--    //         const quantitySpan = document.getElementById(`quantity-${productId}`);-->
<!--    //         let quantity = parseInt(quantitySpan.innerText);-->
<!--    //-->
<!--    //         if (quantity < stock) {-->
<!--    //             quantity++;-->
<!--    //             quantitySpan.innerText = quantity; // Обновляем отображаемое количество-->
<!--    //-->
<!--    //             // Обновляем корзину в cookie-->
<!--    //             updateCart(productId, 1); // Увеличиваем на 1-->
<!--    //         }-->
<!--    //     });-->
<!--    // });-->
<!--    //-->
<!--    // document.querySelectorAll(".decrement-btn").forEach(button => {-->
<!--    //     button.addEventListener("click", function () {-->
<!--    //         const productId = this.dataset.id;-->
<!--    //         const quantitySpan = document.getElementById(`quantity-${productId}`);-->
<!--    //         let quantity = parseInt(quantitySpan.innerText);-->
<!--    //-->
<!--    //         if (quantity > 0) {-->
<!--    //             quantity&#45;&#45;;-->
<!--    //             quantitySpan.innerText = quantity; // Обновляем отображаемое количество-->
<!--    //-->
<!--    //             // Обновляем корзину в cookie-->
<!--    //             updateCart(productId, -1); // Уменьшаем на 1-->
<!--    //         }-->
<!--    //     });-->
<!--    // });-->
<!--    //-->
<!--    //-->
<!--    // // Функция для установки cookie-->
<!--    // function setCookie(name, value, days) {-->
<!--    //     const d = new Date();-->
<!--    //     d.setTime(d.getTime() + (days * 24 * 60 * 60 * 1000)); // Устанавливаем время жизни cookie-->
<!--    //     const expires = "expires=" + d.toUTCString();-->
<!--    //     document.cookie = name + "=" + JSON.stringify(value) + ";" + expires + ";path=/";-->
<!--    // }-->
<!--    //-->
<!--    // // Функция для получения cookie-->
<!--    // function getCookie(name) {-->
<!--    //     const nameEq = name + "=";-->
<!--    //     const ca = document.cookie.split(';');-->
<!--    //     for (let i = 0; i < ca.length; i++) {-->
<!--    //         let c = ca[i];-->
<!--    //         while (c.charAt(0) == ' ') c = c.substring(1, c.length); // Убираем пробелы в начале-->
<!--    //         if (c.indexOf(nameEq) == 0) return JSON.parse(c.substring(nameEq.length, c.length));-->
<!--    //     }-->
<!--    //     return null;-->
<!--    // }-->
<!--    //-->
<!--    // // Функция для обновления товара в корзине-->
<!--    // function updateCart(productId, quantity) {-->
<!--    //     let cart = getCookie('cart') || {}; // Получаем текущую корзину или создаём пустую-->
<!--    //-->
<!--    //     // Обновляем количество товара в корзине-->
<!--    //     if (cart[productId]) {-->
<!--    //         cart[productId] += quantity; // Увеличиваем количество на указанное-->
<!--    //     } else {-->
<!--    //         cart[productId] = quantity; // Если товара нет в корзине, добавляем его-->
<!--    //     }-->
<!--    //-->
<!--    //     // Сохраняем обновлённую корзину в cookie-->
<!--    //     setCookie('cart', cart, 7); // Храним корзину в cookies на 7 дней-->
<!--    // }-->
<!--    //-->
<!--    //-->
<!--    // // Инициализация количества товаров на основе данных из cookies-->
<!--    // window.onload = function() {-->
<!--    //     const cart = getCookie('cart') || {}; // Получаем текущую корзину или создаём пустую-->
<!--    //-->
<!--    //     // Для каждого товара из корзины обновляем количество на странице-->
<!--    //     for (const productId in cart) {-->
<!--    //         const quantity = cart[productId];-->
<!--    //         const quantitySpan = document.getElementById(`quantity-${productId}`);-->
<!--    //         if (quantitySpan) {-->
<!--    //             quantitySpan.innerText = quantity; // Устанавливаем количество из корзины-->
<!--    //         }-->
<!--    //     }-->
<!--    // };-->

<!--    document.querySelectorAll(".increment-btn").forEach(button => {-->
<!--        button.addEventListener("click", function () {-->
<!--            const productId = this.dataset.id;-->
<!--            const stock = parseInt(this.dataset.stock); // Доступное количество товара-->
<!--            const quantitySpan = document.getElementById(`quantity-${productId}`);-->
<!--            let quantity = parseInt(quantitySpan.innerText);-->

<!--            if (quantity < stock) {-->
<!--                quantity++;-->
<!--                quantitySpan.innerText = quantity; // Обновляем отображаемое количество-->

<!--                // Обновляем корзину в cookie-->
<!--                updateCart(productId, 1); // Увеличиваем на 1-->

<!--                // Показываем счётчик и скрываем кнопку "В корзину"-->
<!--                updateCartButtonVisibility(productId, quantity);-->
<!--            }-->
<!--        });-->
<!--    });-->

<!--    document.querySelectorAll(".decrement-btn").forEach(button => {-->
<!--        button.addEventListener("click", function () {-->
<!--            const productId = this.dataset.id;-->
<!--            const quantitySpan = document.getElementById(`quantity-${productId}`);-->
<!--            let quantity = parseInt(quantitySpan.innerText);-->

<!--            if (quantity > 0) {-->
<!--                quantity&#45;&#45;;-->
<!--                quantitySpan.innerText = quantity; // Обновляем отображаемое количество-->

<!--                // Обновляем корзину в cookie-->
<!--                updateCart(productId, -1); // Уменьшаем на 1-->

<!--                // Показываем счётчик и скрываем кнопку "В корзину"-->
<!--                updateCartButtonVisibility(productId, quantity);-->
<!--            }-->
<!--        });-->
<!--    });-->

<!--    // Функция для отображения/скрытия кнопки и счётчика-->
<!--    function updateCartButtonVisibility(productId, quantity) {-->
<!--        const addToCartButton = document.querySelector(`#product-${productId} .add-to-cart-btn`);-->
<!--        const cartCounter = document.querySelector(`#cart-counter-${productId}`);-->
<!--        const quantityInCartSpan = document.querySelector(`#quantity-in-cart-${productId}`);-->

<!--        if (quantity > 0) {-->
<!--            addToCartButton.style.display = "none";-->
<!--            cartCounter.style.display = "block";-->
<!--            quantityInCartSpan.innerText = quantity; // Показываем количество в счётчике-->
<!--        } else {-->
<!--            addToCartButton.style.display = "block";-->
<!--            cartCounter.style.display = "none";-->
<!--        }-->
<!--    }-->

<!--    // Инициализация количества товаров на основе данных из cookies-->
<!--    window.onload = function() {-->
<!--        const cart = getCookie('cart') || {}; // Получаем текущую корзину или создаём пустую-->

<!--        // Для каждого товара из корзины обновляем количество на странице-->
<!--        for (const productId in cart) {-->
<!--            const quantity = cart[productId];-->
<!--            const quantitySpan = document.getElementById(`quantity-${productId}`);-->
<!--            const quantityInCartSpan = document.getElementById(`quantity-in-cart-${productId}`);-->
<!--            const addToCartButton = document.querySelector(`#product-${productId} .add-to-cart-btn`);-->
<!--            const cartCounter = document.querySelector(`#cart-counter-${productId}`);-->

<!--            if (quantitySpan) {-->
<!--                quantitySpan.innerText = quantity; // Устанавливаем количество товара на странице-->
<!--            }-->
<!--            if (quantityInCartSpan) {-->
<!--                quantityInCartSpan.innerText = quantity; // Устанавливаем количество в счётчике-->
<!--            }-->

<!--            // Отображаем кнопку или счётчик в зависимости от количества-->
<!--            if (quantity > 0) {-->
<!--                addToCartButton.style.display = "none";-->
<!--                cartCounter.style.display = "block";-->
<!--            } else {-->
<!--                addToCartButton.style.display = "block";-->
<!--                cartCounter.style.display = "none";-->
<!--            }-->
<!--        }-->
<!--    };-->

<!--</script>-->
<!--</body>-->
<!--</html>-->

<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<div th:replace="~{fragments/head}"></div>
<body>

<!-- Header -->
<div th:replace="~{fragments/asdfsdfheader}"></div>

<div class="container my-5">
    <div class="row">
        <!-- Sidebar for filters -->
        <div th:replace="~{fragments/filter}"></div>

        <!-- Product Listings -->
        <div class="col-md-9">
            <div class="row row-cols-1 row-cols-md-3 g-4">

                <div class="col" th:each="smartphone : ${smartphones}" th:id="'product-' + ${smartphone.id}">

                    <div class="product-card border p-3 d-flex flex-column h-100 position-relative">
                        <a th:href="@{/smartphones/{id}(id=${smartphone.id})}"
                           class="text-decoration-none text-dark h-100 d-flex flex-column">
                            <img src="https://via.placeholder.com/150" alt="Smartphone Image"
                                 class="product-image w-100">

                            <h6 class="mt-auto" th:text="${smartphone.fullName}"></h6>

                            <!-- Значок скидки, отображается в верхнем правом углу, если есть скидка -->
                            <span th:if="${smartphone.discount > 0}"
                                  class="badge bg-danger position-absolute top-0 end-0 rounded-pill"
                                  th:text="${'-' + smartphone.discount + '%'}">
                        </span>
                        </a>
                        <!-- Блок с ценами для выравнивания -->
                        <div class="mt-auto">
                            <!-- Если есть скидка, показывается PriceWithDiscount, а PriceExDiscount зачёркнут -->
                            <span th:if="${smartphone.discount > 0}" class="product-price fw-bold text-primary mb-0"
                                  th:text="${smartphone.priceWithDiscount + ' ₽'}">
                            </span>
                            <span th:if="${smartphone.discount > 0}"
                                  class="text-muted text-decoration-line-through mb-0"
                                  th:text="${smartphone.priceExDiscount + ' ₽'}">
                            </span>

                            <!-- Если скидки нет, показывается только PriceExDiscount без зачёркивания -->
                            <p th:if="${smartphone.discount == 0}" class="fw-bold text-primary mb-0"
                               th:text="${smartphone.priceExDiscount + ' ₽'}">
                            </p>
                        </div>

                        <!-- Количество товара и кнопки " + " и " - " -->
                        <div class="mt-3 d-none" th:id="'quantity-container-' + ${smartphone.id}">
                            <button class="decrement-btn btn btn-sm btn-outline-secondary"
                                    th:data-id="${smartphone.id}">-
                            </button>
                            <span th:id="'quantity-' + ${smartphone.id}" class="mx-2" th:text="0">0</span>
                            <button class="increment-btn btn btn-sm btn-outline-secondary" th:data-id="${smartphone.id}"
                                    th:data-stock="${smartphone.count}">+
                            </button>
                        </div>

                        <!-- Кнопка "В корзину", изначально отображается -->
                        <div class="add-to-cart-container mt-3" th:id="'add-to-cart-container-' + ${smartphone.id}">
                            <button class="btn btn-primary btn-sm w-100 add-to-cart-btn"
                                    th:data-id="${smartphone.id}">
                                В корзину
                            </button>
                        </div>

                        <!-- Кнопка "В корзину" исчезает, когда товар в корзине -->
                        <form class="mt-3 d-none" method="post" th:action="@{/cart/${smartphone.id}}">
                            <button class="btn btn-primary btn-sm w-100">В корзину</button>
                        </form>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>

<div th:replace="~{fragments/footer}"></div>

</body>
</html>

